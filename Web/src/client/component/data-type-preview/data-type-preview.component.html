<p-dialog
  *ngIf="dataType() !== undefined"
  header="Data Type Preview"
  closable="true"
  closeOnEscape="true"
  modal="true"
  styleClass="min-w-128"
  (close)="hide()"
  (onHide)="hide()"
  [(visible)]="isShown"
>
  <p class="font-bold">Name</p>
  <p>{{ dataType()!.name }}</p>

  <p class="font-bold mt-4">Display Field</p>
  <p>{{ getDisplayFieldName() }}</p>

  <p class="font-bold mt-4">Description</p>
  <p>{{ dataType()!.description }}</p>

  <p class="font-bold mt-4">Fields</p>
  <p-table [value]="dataType()!.fields || []">
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Required</th>
        <th>Default Value</th>
      </tr>
    </ng-template>

    <ng-template
      pTemplate="body"
      let-field
    >
      @let isReferenceField = field.type === FieldType.Reference;

      <tr>
        <td><p [ngClass]="{'mt-7': isReferenceField}">{{ field.name }}</p></td>
        <td><p [ngClass]="{'mt-7': isReferenceField}">{{ toFieldTypeLabel(field.type) }}</p></td>
        <td>
          <p
            [ngClass]="{
            'mt-7': isReferenceField,
            'text-green-500': field.isRequired,
            'text-red-500': !field.isRequired}"
          >
            {{ field.isRequired ? 'Yes' : 'No' }}
          </p>
        </td>
        <td>
          @if (isReferenceField) {
            <div class="flex flex-col gap-1">
              <label class="font-semibold">Referenced Type</label>
              {{ getReferencedDataTypeName(field) }}
            </div>
          } @else {
            <data-type-entry-field-display [dataType]="dataType()!" [value]="field.defaultValue" [dataTypeFieldId]="field.id"/>
          }
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="flex justify-end mt-4">
    <p-button
      label="Close"
      class="p-button-secondary"
      (onClick)="hide()"
    />
  </div>
</p-dialog>
