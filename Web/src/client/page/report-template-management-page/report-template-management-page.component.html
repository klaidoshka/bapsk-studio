<div class="flex flex-col w-full items-center justify-center mt-4">
  <div class="min-w-128">
    <h1 class="text-2xl font-bold mb-4">{{ templateId() ? 'Edit' : 'Create' }} Report Template</h1>

    <messages-showcase [messages]="messages()"/>

    <form *ngIf="dataTypes.hasValue()" class="flex flex-col gap-4" [formGroup]="form">
      <div class="flex flex-row gap-4">
        <div class="flex flex-col w-full">
          <label for="name" class="block text-sm font-medium">Name</label>
          <input formControlName="name" pInputText type="text" id="name" class="mt-1 block w-full"/>
          <form-input-error [control]="form.controls.name"/>
        </div>

        <div class="flex flex-col w-full">
          <label for="dataTypeId" class="block text-sm font-medium">Data Type</label>
          <p-select inputId="dataTypeId" [options]="dataTypes.value()" optionLabel="name" placeholder="Select a data type"
                    appendTo="body" styleClass="w-full" class="mt-1" (onChange)="changeFormFields($event.value)"/>
        </div>
      </div>

      <div class="flex flex-col">
        <label for="fields" class="block text-sm font-medium">Fields</label>
        <p-table styleClass="w-full mt-2 dark:bg-primary-950! bg-primary-50!"
                 paginatorStyleClass="dark:bg-primary-950! bg-primary-50!" id="fields" formArrayName="fields"
                 [value]="form.controls.fields.controls">
          <ng-template #header>
            <tr>
              <th>Name</th>
            </tr>
          </ng-template>

          <ng-template #body let-formField>
            <tr [formGroup]="formField">
              <td>{{ formField.value.name }}</td>
            </tr>
          </ng-template>
        </p-table>
      </div>

      <div class="flex justify-end mt-4">
        <p-button [label]="template.hasValue() ? 'Save' : 'Create'" [disabled]="form.invalid || !form.dirty"
                  (onClick)="save()" type="submit"/>
      </div>
    </form>
  </div>
</div>
