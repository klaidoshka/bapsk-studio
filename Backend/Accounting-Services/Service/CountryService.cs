using Accounting.Contract.Entity;
using Accounting.Contract.Service;

namespace Accounting.Services.Service;

public class CountryService : ICountryService
{
    private static readonly Dictionary<string, string> CountriesToLithuanianName = new()
    {
        ["AF"] = "Afganistano Islamo Respublika",
        ["AX"] = "Alandų Salos",
        ["AL"] = "Albanijos Respublika",
        ["DZ"] = "Alžyro Liaudies Demokratinė Respublika",
        ["AS"] = "Amerikos Samoa",
        ["AD"] = "Andoros Kunigaikštystė",
        ["AO"] = "Angolos Respublika",
        ["AI"] = "Angilija",
        ["AQ"] = "Antarktida",
        ["AG"] = "Antigva ir Barbuda",
        ["AR"] = "Argentinos Respublika",
        ["AM"] = "Armėnijos Respublika",
        ["AW"] = "Aruba",
        ["AU"] = "Australijos Sandrauga",
        ["AT"] = "Austrijos Respublika",
        ["AZ"] = "Azerbaidžano Respublika",
        ["BS"] = "Bahamų Sandrauga",
        ["BH"] = "Bahreino Karalystė",
        ["BD"] = "Bangladešo Liaudies Respublika",
        ["BB"] = "Barbadosas",
        ["BY"] = "Baltarusijos Respublika",
        ["BE"] = "Belgijos Karalystė",
        ["BZ"] = "Belizas",
        ["BJ"] = "Benino Respublika",
        ["BM"] = "Bermuda",
        ["BT"] = "Butano Karalystė",
        ["BO"] = "Bolivijos Daugiatautė Valstybė",
        ["BQ"] = "Karibų Nyderlandai",
        ["BA"] = "Bosnijos ir Hercegovinos Respublika",
        ["BW"] = "Botsvanos Respublika",
        ["BV"] = "Buvė Sala",
        ["BR"] = "Brazilijos Federacinė Respublika",
        ["IO"] = "Indijos Vandenyno Britų Teritorija",
        ["BN"] = "Brunėjaus Darusalamas",
        ["BG"] = "Bulgarijos Respublika",
        ["BF"] = "Burkina Fasas",
        ["BI"] = "Burundžio Respublika",
        ["KH"] = "Kambodžos Karalystė",
        ["CM"] = "Kamerūno Respublika",
        ["CA"] = "Kanada",
        ["CV"] = "Žaliojo Kyšulio Respublika",
        ["KY"] = "Kaimanų Salos",
        ["CF"] = "Centrinės Afrikos Respublika",
        ["TD"] = "Čado Respublika",
        ["CL"] = "Čilės Respublika",
        ["CN"] = "Kinijos Liaudies Respublika",
        ["CX"] = "Kalėdų Sala",
        ["CC"] = "Kokosų (Kilingo) Salos",
        ["CO"] = "Kolumbijos Respublika",
        ["KM"] = "Komorų Sąjunga",
        ["CG"] = "Kongo Respublika",
        ["CD"] = "Kongo Demokratinė Respublika",
        ["CK"] = "Kuko Salos",
        ["CR"] = "Kosta Rikos Respublika",
        ["CI"] = "Dramblio Kaulo Kranto Respublika",
        ["HR"] = "Kroatijos Respublika",
        ["CU"] = "Kubos Respublika",
        ["CW"] = "Kiurasao",
        ["CY"] = "Kipro Respublika",
        ["CZ"] = "Čekijos Respublika",
        ["DK"] = "Danijos Karalystė",
        ["DJ"] = "Džibučio Respublika",
        ["DM"] = "Dominikos Sandrauga",
        ["DO"] = "Dominikos Respublika",
        ["EC"] = "Ekvadoro Respublika",
        ["EG"] = "Egipto Arabų Respublika",
        ["SV"] = "Salvadoro Respublika",
        ["GQ"] = "Pusiaujo Gvinėjos Respublika",
        ["ER"] = "Eritrėjos Valstybė",
        ["EE"] = "Estijos Respublika",
        ["ET"] = "Etiopijos Federacinė Demokratinė Respublika",
        ["FK"] = "Folklando (Malvinų) Salos",
        ["FO"] = "Farerų Salos",
        ["FJ"] = "Fidžio Salų Respublika",
        ["FI"] = "Suomijos Respublika",
        ["FR"] = "Prancūzijos Respublika",
        ["GF"] = "Prancūzijos Gviana",
        ["PF"] = "Prancūzijos Polinezija",
        ["TF"] = "Prancūzijos Pietų ir Antarkties Sritys",
        ["GA"] = "Gabono Respublika",
        ["GM"] = "Gambijos Respublika",
        ["GE"] = "Gruzija",
        ["DE"] = "Vokietijos Federacinė Respublika",
        ["GH"] = "Ganos Respublika",
        ["GI"] = "Gibraltaras",
        ["GR"] = "Graikijos Respublika",
        ["GL"] = "Grenlandija",
        ["GD"] = "Grenada",
        ["GP"] = "Gvadelupa",
        ["GU"] = "Guamo Teritorija",
        ["GT"] = "Gvatemalos Respublika",
        ["GG"] = "Gernsis",
        ["GN"] = "Gvinėjos Respublika",
        ["GW"] = "Bisau Gvinėjos Respublika",
        ["GY"] = "Gajanos Respublika",
        ["HT"] = "Haičio Respublika",
        ["HM"] = "Herdo ir Makdonaldo Salos",
        ["VA"] = "Šventasis Sostas (Vatikano Miesto Valstybė)",
        ["HN"] = "Hondūro Respublika",
        ["HK"] = "Ypatingasis Administracinis Kinijos Regionas Honkongas",
        ["HU"] = "Vengrijos Respublika",
        ["IS"] = "Islandijos Respublika",
        ["IN"] = "Indijos Respublika",
        ["ID"] = "Indonezijos Respublika",
        ["IR"] = "Irano Islamo Respublika",
        ["IQ"] = "Irako Respublika",
        ["IE"] = "Airija",
        ["IM"] = "Meno sala",
        ["IL"] = "Izraelio Valstybė",
        ["IT"] = "Italijos Respublika",
        ["JM"] = "Jamaika",
        ["JP"] = "Japonija",
        ["JE"] = "Džersis",
        ["JO"] = "Jordanijos Hašimitų Karalystė",
        ["KZ"] = "Kazachstano Respublika",
        ["KE"] = "Kenijos Respublika",
        ["KI"] = "Kiribačio Respublika",
        ["KP"] = "Korėjos Liaudies Demokratinė Respublika",
        ["KR"] = "Korėjos Respublika",
        ["KW"] = "Kuveito Valstybė",
        ["KG"] = "Kirgizijos Respublika",
        ["LA"] = "Laoso Liaudies Demokratinė Respublika",
        ["LV"] = "Latvijos Respublika",
        ["LB"] = "Libano Respublika",
        ["LS"] = "Lesoto Karalystė",
        ["LR"] = "Liberijos Respublika",
        ["LY"] = "Libijos Arabų Socialistinė Liaudies Džamachirija",
        ["LI"] = "Lichtenšteino Kunigaikštystė",
        ["LT"] = "Lietuvos Respublika",
        ["LU"] = "Liuksemburgo Didžioji Hercogystė",
        ["MO"] = "Ypatingasis Administracinis Kinijos Regionas Makao",
        ["MK"] = "Šiaurės Makedonija",
        ["MG"] = "Madagaskaro Respublika",
        ["MW"] = "Malavio Respublika",
        ["MY"] = "Malaizija",
        ["MV"] = "Maldyvų Respublika",
        ["ML"] = "Malio Respublika",
        ["MT"] = "Maltos Respublika",
        ["MH"] = "Maršalo Salų Respublika",
        ["MQ"] = "Martinika",
        ["MR"] = "Mauritanijos Islamo Respublika",
        ["MU"] = "Mauricijaus Respublika",
        ["YT"] = "Majoto Teritorinė Bendrija",
        ["MX"] = "Meksikos Jungtinės Valstijos",
        ["FM"] = "Mikronezijos Federacinės Valstijos",
        ["MD"] = "Moldovos Respublika",
        ["MC"] = "Monako Kunigaikštystė",
        ["MN"] = "Mongolija",
        ["ME"] = "Juodkalnija",
        ["MS"] = "Montseratas",
        ["MA"] = "Maroko Karalystė",
        ["MZ"] = "Mozambiko Respublika",
        ["MM"] = "Mianmaro Sąjunga",
        ["NA"] = "Namibijos Respublika",
        ["NR"] = "Nauru Respublika",
        ["NP"] = "Nepalas",
        ["NL"] = "Nyderlandų Karalystė",
        ["NC"] = "Naujoji Kaledonija ir Pavaldžios Teritorijos",
        ["NZ"] = "Naujoji Zelandija",
        ["NI"] = "Nikaragvos Respublika",
        ["NE"] = "Nigerio Respublika",
        ["NG"] = "Nigerijos Federacinė Respublika",
        ["NU"] = "Niujės Respublika",
        ["NF"] = "Norfolko Sala",
        ["MP"] = "Marianos Šiaurinių Salų Sandrauga",
        ["NO"] = "Norvegijos Karalystė",
        ["OM"] = "Omano Sultonatas",
        ["PK"] = "Pakistano Islamo Respublika",
        ["PW"] = "Palau Respublika",
        ["PS"] = "Okupuotoji Palestinos Teritorija",
        ["PA"] = "Panamos Respublika",
        ["PG"] = "Papua Naujosios Gvinėjos Nepriklausomoji Valstybė",
        ["PY"] = "Paragvajaus Respublika",
        ["PE"] = "Peru Respublika",
        ["PH"] = "Filipinų Respublika",
        ["PN"] = "Pitkerno Salos",
        ["PL"] = "Lenkijos Respublika",
        ["PT"] = "Portugalijos Respublika",
        ["PR"] = "Puerto Riko Sandrauga",
        ["QA"] = "Kataro Valstybė",
        ["RE"] = "Reunjonas",
        ["RO"] = "Rumunija",
        ["RU"] = "Rusijos Federacija",
        ["RW"] = "Ruandos Respublika",
        ["BL"] = "Šv. Bartolomėjaus sala",
        ["SH"] = "Šv. Elenos Sala ir Pavaldžios Teritorijos",
        ["KN"] = "Sent Kitso ir Nevio Federacija",
        ["LC"] = "Sent Lusija",
        ["MF"] = "Sen Martenas (Prancūzijos užjūrio bendrija)",
        ["PM"] = "Sen Pjero ir Mikelono Teritorinė Bendrija",
        ["VC"] = "Sent Vinsentas ir Grenadinai",
        ["WS"] = "Samoa Neprikausomoji Valstybė",
        ["SM"] = "San Marino Respublika",
        ["ST"] = "San Tomė ir Prinsipės Demokratinė Respublika",
        ["SA"] = "Saudo Arabijos Karalystė",
        ["SN"] = "Senegalo Respublika",
        ["RS"] = "Serbijos Respublika",
        ["SC"] = "Seišelių Respublika",
        ["SL"] = "Siera Leonės Respublika",
        ["SG"] = "Singapūro Respublika",
        ["SX"] = "Sint Martenas",
        ["SK"] = "Slovakijos Respublika",
        ["SI"] = "Slovėnijos Respublika",
        ["SB"] = "Saliamono Salos",
        ["SO"] = "Somalio Respublika",
        ["ZA"] = "Pietų Afrikos Respublika",
        ["GS"] = "Pietų Džordžijos ir Pietų Sandvičo Salos",
        ["SS"] = "Pietų Sudanas",
        ["ES"] = "Ispanijos Karalystė",
        ["LK"] = "Šri Lankos Demokratinė Socialistinė Respublika",
        ["SD"] = "Sudano Respublika",
        ["SR"] = "Surinamo Respublika",
        ["SJ"] = "Svalbardo ir Jano Majeno Salos",
        ["SZ"] = "Svazilando Karalystė",
        ["SE"] = "Švedijos Karalystė",
        ["CH"] = "Šveicarijos Konfederacija",
        ["SY"] = "Sirijos Arabų Respublika",
        ["TW"] = "Taivanas, Kinijos Respublika",
        ["TJ"] = "Tadžikistano Respublika",
        ["TZ"] = "Tanzanijos Jungtinė Respublika",
        ["TH"] = "Tailando Karalystė",
        ["TL"] = "Timoro-Leste Demokratinė Respublika",
        ["TG"] = "Togo Respublika",
        ["TK"] = "Tokelau",
        ["TO"] = "Tongos Karalystė",
        ["TT"] = "Trinidado ir Tobago Respublika",
        ["TN"] = "Tuniso Respublika",
        ["TR"] = "Turkijos Respublika",
        ["TM"] = "Turkmėnistanas",
        ["TC"] = "Terkso ir Kaikoso Salos",
        ["TV"] = "Tuvalu",
        ["UG"] = "Ugandos Respublika",
        ["UA"] = "Ukraina",
        ["AE"] = "Jungtiniai Arabų Emyratai",
        ["GB"] = "Jungtinė Didžiosios Britanijos ir Šiaurės Airijos Karalystė",
        ["US"] = "Jungtinės Amerikos Valstijos",
        ["UM"] = "Jungtinių Valstijų Mažosios Tolimosios Salos",
        ["UY"] = "Urugvajaus Rytų Respublika",
        ["UZ"] = "Uzbekistano Respublika",
        ["VU"] = "Vanuatu Respublika",
        ["VE"] = "Venesuelos Bolivaro Respublika",
        ["VN"] = "Vietnamo Socialistinė Respublika",
        ["VG"] = "Didžiosios Britanijos Mergelių Salos",
        ["VI"] = "Jungtinių Valstijų Mergelių Salos",
        ["WF"] = "Voliso ir Futūnos salos",
        ["EH"] = "Vakarų Sachara",
        ["YE"] = "Jemeno Respublika",
        ["ZM"] = "Zambijos Respublika",
        ["ZW"] = "Zimbabvės Respublika"
    };

    public IsoCountryCode GetCountryCode(string name, IsoCountryCode @default = IsoCountryCode.LT)
    {
        var nameTrimmed = name.Trim();

        var candidate = CountriesToLithuanianName.FirstOrDefault(
            x => x.Value.Equals(nameTrimmed, StringComparison.OrdinalIgnoreCase)
        );

        return candidate.Key is null ? @default : Enum.Parse<IsoCountryCode>(candidate.Key);
    }
}